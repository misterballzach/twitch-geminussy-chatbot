<!DOCTYPE html>
<html>
<head>
    <title>Twitch Bot Dashboard</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <h1>Gemini Twitch Bot Dashboard</h1>

    <label>Personality:</label>
    <input type="text" id="personality" value="{{ config['personality'] }}">
    <br><br>

    <label>Auto Chat Frequency:</label>
    <input type="range" id="freq" min="0" max="1" step="0.01" value="{{ config['auto_chat_freq'] }}">
    <span id="freq_val">{{ config['auto_chat_freq'] }}</span>
    <br><br>

    <label>Send !say Message:</label>
    <input type="text" id="say_msg">
    <button onclick="sendMessage()">Send</button>

    <script>
        const socket = io();

        const personalityInput = document.getElementById("personality");
        const freqInput = document.getElementById("freq");
        const freqVal = document.getElementById("freq_val");

        freqInput.addEventListener("input", () => {
            freqVal.innerText = freqInput.value;
            updateConfig();
        });

        personalityInput.addEventListener("change", updateConfig);

        function updateConfig() {
            socket.emit("update_config", {
                personality: personalityInput.value,
                auto_chat_freq: parseFloat(freqInput.value)
            });
        }

        function sendMessage() {
            const msg = document.getElementById("say_msg").value;
            if(msg) {
                socket.emit("send_message", {message: msg});
                document.getElementById("say_msg").value = "";
            }
        }

        socket.on("config_updated", (config) => {
            personalityInput.value = config.personality;
            freqInput.value = config.auto_chat_freq;
            freqVal.innerText = config.auto_chat_freq;
        });
    </script>
</body>
</html>
